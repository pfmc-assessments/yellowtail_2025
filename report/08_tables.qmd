# Tables 

## Data
```{r} 
#| label: 'set-rda-dir-tbls'
#| echo: false
#| warning: false
#| eval: true
#| include: false
library(tidyr)
library(gt)
``` 


<!-- Needs Alt text -->
```{r, orbs_perc_pos}
#| label: tbl-percent_pos
#| echo: false
#| warning: false
#| tbl-cap: "Summary of trips from ORBS dockside sampling from ODFW"


percpos <- read.csv("Tables/yellowtail_percent_pos.csv") |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```

{{< pagebreak >}}

::: {.landscape}
<!-- Needs Alt text -->
```{r}
#| label: tbl-orbs_mod_select
#| echo: false
#| warning: false
#| tbl-cap: "Model selection for top ten covariate combinations considered for the ORBS index"

orbs_modselect <- read.csv("Tables/yellowtail_model_selection.csv")[1:10, ]
orbs_modselect[orbs_modselect == "Included"] <- "Incl."
orbs_modselect |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```

:::

{{< pagebreak >}}
<!-- Needs Alt text -->
```{r}
#| label: tbl-orbs_index
#| echo: false
#| warning: false
#| tbl-cap: "Relative index of abundance from ORBS dockside sampling from ODFW."

read.csv("Tables/index_forreport_ORBS.csv") |> 
  dplyr::mutate(dplyr::across(-1, round, 3)) |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```
<!-- Needs Alt text -->
```{r}
#| label: tbl-smurf_mod_select
#| echo: false
#| warning: false
#| tbl-cap: "Model selection for covariate combinations considered for the SMURF YOY index"

smurf_modselect <- read.csv("Tables/SMURF_model_selection.csv")
smurf_modselect[smurf_modselect == "Included"] <- "Incl."
smurf_modselect |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```
<!-- Needs Alt text -->
```{r}
#| label: tbl-smurf_index
#| echo: false
#| warning: false
#| tbl-cap: "Relative index of abundance from SMURF YOY index."

smurf_in <- read.csv("Tables/SMURF_index.csv")
smurf_in |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```


```{r, rec_bio}
#| label: tbl-rec-bio
#| echo: false
#| warning: false
#| tbl-cap: "Sample sizes for age and length samples from the recreational fishery."

rec_bio_table <- read.csv("../Data/Processed/rec_bio_sample_size_table.csv", check.names = FALSE)
rec_bio_table |> 
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```

```{r, rec_bio}
#| label: tbl-wcgbts-bio
#| echo: false
#| warning: false
#| tbl-cap: "Sample sizes for the age and length compositions from the WCGBTS. The ages are treated as conditioned on length and use the number of fish (within each length bin) as the input sample size."

wcgbts_bio_table <- read.csv("../Data/Processed/input_n_wcgbts.csv", check.names = FALSE)
wcgbts_bio_table |> 
  gt() |>
  cols_label(
    year = "Year",
    n_ages = "N. ages",
    n_tows = "N. tows",
    n_lengths = "N. lengths",
    input_n = "Input N."
  ) |> 
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```

```{r, rec_bio}
#| label: tbl-tri-bio
#| echo: false
#| warning: false
#| tbl-cap: "Sample sizes for the marginal age and length compositions from the Triennial survey."

tri_bio_table <- read.csv("../Data/Processed/input_n_tri.csv", check.names = FALSE)
tri_bio_table |> 
  gt() |>
    cols_label(
    year = "Year",
    n_tows_ages = "N. tows with ages",
    n_ages = "N. ages",
    input_n_ages = "Input N. for ages",
    n_tows_lengths = "N. tows with lengths",
    n_lengths = "N. lengths",
    input_n_lengths = "Input N. for lengths"
  ) |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()

```



## Model results
 
```{r}
#| label: tbl-model-config
#| warning: false
#| echo: false
#| tbl-cap: !expr if(eval_tables) config_cap

config_table |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```


```{r}
#| label: tbl-n-param
#| warning: false
#| echo: false
#| tbl-cap: !expr if(eval_tables) parcount_cap

parcount_table |>
  dplyr::filter(Count > 0) |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```

::: {.landscape}

```{r}
#| label: tbl-pars
#| warning: false
#| echo: false
#| tbl-cap: !expr if(eval_tables) pars_cap

pars_table |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```
:::


```{r}
#| label: tbl-compweight
#| warning: false
#| echo: false
#| tbl-cap: !expr if(eval_tables) compweight_cap

compweight_table |>
  gt() |>
  tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE
  ) |>
  as_latex()
```

```{r, results = "asis"}
#| label: tbl-ts
#| warning: false
#| echo: false
#| eval: !expr eval_tables 
#| tbl-cap: !expr if(eval_tables) time_series_cap 
#| tbl-pos: H

time_series_table |>
kableExtra::kable(
  format = "latex", 
  longtable = TRUE,
  booktabs = TRUE,
  caption = "Time series of population estimates from the base model.",
  linesep = "") |>
  kableExtra::kable_styling(
    latex_options = "repeat_header",
    font_size = 8) |>
  kableExtra::column_spec(
    column = 1:9,
    width = "0.5in"
  )
```

\pagebreak

::: {.landscape}

```{r, results = "asis"}
#| label: tbl-projections
#| warning: false
#| echo: false
#| eval: !expr eval_tables 
#| tbl-cap: !expr if(eval_tables) projections_cap 
#| tbl-pos: H

projections_table |>
  gt::gt() |>
  gt::fmt_number(
    columns = c(2:5, 7:9),
    decimals = 0
  ) |>
  gt::fmt_number(
    columns = c(6, 10),
    decimals = 3
  ) |>
  gt::tab_options(
    table.font.size = 12,
    latex.use_longtable = TRUE 
  ) |>
  gt::sub_missing(
    columns = tidyselect::everything(),
    missing_text = "---"
  ) |>
  gt::cols_align(
    align = "center"
  ) |>
  gt::cols_width(
    tidyselect::everything() ~ px(75)
  ) |>
  gt::as_latex()

```

:::

\pagebreak
